{% extends 'usuarios/base.html' %}

{% block title %}Agendamentos{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">

    <a href="{% url 'recepcao_dashboard' %}" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Voltar para Recepção
    </a>

    <h2 class="fw-bold">
        <i class="bi bi-calendar-event text-success"></i>
        Agendamentos
    </h2>

    <a href="{% url 'agendar_paciente' %}" class="btn btn-success">
        <i class="bi bi-plus-circle"></i> Novo Agendamento
    </a>
</div>

<div class="card shadow-sm">
    <div class="card-body">

        {% if agendamentos %}
        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead class="table-light">
    <tr>
        <th>Paciente</th>
        <th>Data</th>
        <th>Hora</th>
        <th>Status</th>
        <th class="text-center">Ação</th>
    </tr>
</thead>
<tbody>
    {% for a in agendamentos %}
    <tr>
        <td>
            <i class="bi bi-person-fill text-primary"></i>
            {{ a.paciente.nome }}
        </td>

        <td>
            {{ a.data|date:"d/m/Y" }}
        </td>

        <td>
            <i class="bi bi-clock text-secondary"></i>
            {{ a.hora|time:"H:i" }}
        </td>

        <td>
            {% if a.status == "AGENDADO" %}
                <span class="badge bg-warning text-dark">Agendado</span>
            {% elif a.status == "TRIAGEM" %}
                <span class="badge bg-info text-dark">Em Triagem</span>
            {% elif a.status == "FINALIZADO" %}
                <span class="badge bg-success">Finalizado</span>
            {% endif %}
        </td>

        <td class="text-center">
            {% if a.status == "AGENDADO" %}
                <a href="{% url 'enviar_para_triagem' a.id %}"
                   class="btn btn-sm btn-primary">
                    <i class="bi bi-arrow-right-circle"></i>
                    Enviar
                </a>
            {% else %}
                <span class="text-muted">—</span>
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</tbody>

            </table>
        </div>
        {% else %}
            <div class="text-center py-4">
                <i class="bi bi-calendar-x fs-1 text-muted"></i>
                <p class="text-muted mt-2">Nenhum agendamento encontrado.</p>
            </div>
        {% endif %}

    </div>
</div>

{% endblock %}
